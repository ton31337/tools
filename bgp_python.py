# Trivial example on how to send a plain BGP (malformed too) packets.
# Tested with FRR:
#
#router bgp 65001
# neighbor 127.0.0.1 remote-as external
# neighbor 127.0.0.1 passive
# neighbor 127.0.0.1 ebgp-multihop
# neighbor 127.0.0.1 disable-connected-check
# neighbor 127.0.0.1 update-source 127.0.0.2
# neighbor 127.0.0.1 timers 3 90
# neighbor 127.0.0.1 timers connect 1

import socket
import time

OPEN = (b"\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff" 
b"\xff\xff\x00\x62\x01\x04\xfd\xea\x00\x5a\x0a\x00\x00\x01\x45\x02" 
b"\x06\x01\x04\x00\x01\x00\x01\x02\x02\x02\x00\x02\x02\x46\x00\x02" 
b"\x06\x41\x04\x00\x00\xfd\xea\x02\x02\x06\x00\x02\x06\x45\x04\x00" 
b"\x01\x01\x01\x02\x0e\x49\x0c\x0a\x64\x6f\x6e\x61\x74\x61\x73\x2d" 
b"\x70\x63\x00\x02\x04\x40\x02\x00\x78\x02\x09\x47\x07\x00\x01\x01" 
b"\x80\x00\x00\x00")

KEEPALIVE = (b"\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff"
b"\xff\xff\xff\xff\xff\xff\x00\x13\x04")

UPDATE = (
b"\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff" 
b"\x00\x4a\x02\x00\x00\x00\x2f\x40\x01\x01\x00\x40\x02\x06\x02\x01" 
b"\x00\x00\xfd\xea\x40\x03\x04\x05\x06\x07\x08\xc0\x08\x18\x02\xfa" 
b"\x02\xfa\x02\xfa\x56\x5e\x02\xfa\x56\x7c\x02\xfa\x56\x72\x02\xfa" 
b"\x56\x04\x03\x06\xc5\x5c\x18\x01\x02\x03")

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('127.0.0.2', 179))
s.send(OPEN) 
data = s.recv(1024)
s.send(KEEPALIVE)
data = s.recv(1024)
s.send(UPDATE)
data = s.recv(1024)
time.sleep(100)
s.close()

